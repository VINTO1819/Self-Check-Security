# 자가진단 사이트 취약점 보고서
 > 이 보고서는 VINTO가 작성하였으며 MIT 라이센스로 배포됩니다.
 > 또한 이 보고서를 악용하여 발생하는 법적 책임은 모두 당사자에게 있습니다.

🔑 취약점
============
Script의 난독화 부재
------------
<img src="./selfCheckHomeHTML.png" alt="Chrome Dev Tool을 통해 자가진단 페이지를 본 모습" width="500"/>
   
 > Chrome Dev Tool을 통해 자가진단 페이지를 본 모습

교육부가 개발한 자가진단 홈페이지를 Chrome Dev Tool로 분석한 결과,   
Javascript 코드가 .js 파일로 따로 분리되지 않고 HTML 파일에 ```<Script>``` 태그 형식으로 내장된 것이 확인되었다.
   
또한 Javascript 코드에는 어떠한 난독화 조치도 되어있지 않았다.
   
#### 이는, 공격자가 손쉽게 페이지를 분석하고 공격할 수 있는 기회를 마련한다.

Bruteforce 방지기능의 부재
------------
Ajax를 이용해 동시에 300~400회의 ```HTTP POST Request```를 넣은 결과,
모든 요청에 대해 지연/연결 차단등의 조치 없이 응답을 반환하는 것이 확인되었다.   

300~400회의 Request에 소요된 시간은 단 **2초 이내**로 측정되었다.   
이러한 Bruteforce 차단기능의 부재는 **개인정보를 유출의 가능성을 현저히 높인다.**

SQL Injection 방어의 부재 의심
------------
취약점을 분석하는 도중 자가진단 사이트가 Sql을 사용하는 것으로 의심되는 코드(```SELECT_ERROR```)가 반환되었다.   
대부분의 사이트에서 Sql을 사용하기에 이 정보 자체는 큰 문제가 되지 않을 것으로는 보이나, ```첫번째 취약점```의 사례가 있는 만큼 **SQL Injection 취약점의 존재 가능성도 의심된다.**

🔐 취약점 시연
============
생년월일 및 자가진단 토큰 추출
------------
<img src="./Success_Tool.PNG" alt="Chrome Dev Tool을 통해 자가진단 페이지를 본 모습" width="500"/>
   
 > 본 개발자의 이름/학교명/태어난 년도를 입력하게 되자,
 > 본 개발자의 생년월일은 물론, 자가진단 조작에 필요한 토큰까지 나오게 되었다.


```2번째 취약점```을 이용한 Bruteforce 도구를 개발하여 실험한 것으로,   
특정인의 ```거주 지역```/```이름```/```학교명```/```태어난 년도(필수는 아님)```을 입력하면 **단 1~2초만에 그 사람의 생년월일과 자가진단 등록에 필요한 토큰을 추출**할 수 있다.   
   
이는 매우 심각한 상황으로,   
누군가 악의적인 목적으로 접근하여 이름/학교 정보/지역만을 통해 **해당 사용자의 개인정보**를 알아낼 수 있을 뿐만 아니라,   
   
자가진단 데이터를 조작하여 **피해자가 등교하지 못하도록 하는 등의 행위**까지도 가능해진다.

🔧 해결 방안
============
 * 자가진단 페이지의 Javascript 코드를 .js 파일로 분리하고, 난독화 과정을 거친다.
 * Bruteforce를 방지하기 위해 ```학생의 이름 별``` 분당 요청 횟수를 제한한다.
 * 또한 SQL Injection의 취약점이 의심되는 만큼 ```SQL 저장 프로시저```를 이용하거나 ```입력값 검증```을 추가한다.

🚧 현황
============
 * 2020년 9월 경, 새로 개발된 자가진단 서비스가 출시되었음에도 불구하고 현 취약점을 그대로 보유하고 있는 서비스는 유지되고 있음.
 * 2020년 10월 9일 : 국민신문고 민원을 통해 교육부에 해당 취약점을 통보함 (답변대기중)